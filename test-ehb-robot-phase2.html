<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EHB Robot - Phase 2 Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .status {
            text-align: center;
            padding: 20px;
            background: #e8f5e8;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
        }

        .test-section {
            margin-bottom: 30px;
        }

        .test-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .command-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .command-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .command-card:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .command-card h4 {
            color: #495057;
            margin-bottom: 8px;
        }

        .command-card p {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .test-area {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .input-field {
            flex: 1;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
        }

        .input-field:focus {
            border-color: #667eea;
        }

        .test-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }

        .test-btn:hover {
            background: #5a6fd8;
        }

        .voice-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease;
        }

        .voice-btn:hover {
            background: #218838;
        }

        .voice-btn.listening {
            background: #dc3545;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .results {
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            min-height: 100px;
        }

        .result-item {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .result-item.success {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .result-item.error {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .result-item.processing {
            background: #d1ecf1;
            border-left-color: #17a2b8;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .feature-card h4 {
            color: #333;
            margin-bottom: 10px;
        }

        .feature-card p {
            color: #666;
            font-size: 0.9rem;
        }

        .floating-robot {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .floating-robot:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ EHB Robot</h1>
            <p>Phase 2: Voice-to-Command Actions</p>
        </div>

        <div class="content">
            <div class="status success">
                <h3>‚úÖ Phase 2 Complete!</h3>
                <p>EHB Robot now understands and executes voice/text commands intelligently.</p>
            </div>

            <div class="test-section">
                <h3>üß™ Test Command Parsing</h3>
                <div class="test-area">
                    <div class="input-group">
                        <input type="text" class="input-field" id="commandInput" placeholder="Try: Order 2 cold drinks for tomorrow" />
                        <button class="test-btn" onclick="testCommand()">Test Command</button>
                        <button class="voice-btn" id="voiceBtn" onclick="startVoiceInput()">üé§ Voice</button>
                    </div>
                    <div class="results" id="results">
                        <p>Results will appear here...</p>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <h3>üìù Command Examples</h3>
                <div class="command-examples">
                    <div class="command-card" onclick="testExample('Order 2 cold drinks for tomorrow')">
                        <h4>üõí Order Commands</h4>
                        <p>"Order 2 cold drinks for tomorrow"</p>
                        <p>"Buy 1 milk packet"</p>
                        <p>"Get 3 bread loaves"</p>
                    </div>

                    <div class="command-card" onclick="testExample('Open GoSellr')">
                        <h4>üß≠ Navigation</h4>
                        <p>"Open GoSellr"</p>
                        <p>"Go to wallet"</p>
                        <p>"Show dashboard"</p>
                    </div>

                    <div class="command-card" onclick="testExample('Check my wallet balance')">
                        <h4>üí∞ Wallet</h4>
                        <p>"Check my wallet balance"</p>
                        <p>"Show balance"</p>
                        <p>"Get wallet info"</p>
                    </div>

                    <div class="command-card" onclick="testExample('Book AC repair for next week')">
                        <h4>üîß Services</h4>
                        <p>"Book AC repair for next week"</p>
                        <p>"Schedule electrician"</p>
                        <p>"Appointment for plumber"</p>
                    </div>

                    <div class="command-card" onclick="testExample('Remind me to order milk at 6pm')">
                        <h4>‚è∞ Reminders</h4>
                        <p>"Remind me to order milk at 6pm"</p>
                        <p>"Set reminder for payment"</p>
                        <p>"Remind me tomorrow"</p>
                    </div>

                    <div class="command-card" onclick="testExample('Search for shoes')">
                        <h4>üîç Search</h4>
                        <p>"Search for shoes"</p>
                        <p>"Find electronics"</p>
                        <p>"Look for groceries"</p>
                    </div>
                </div>
            </div>

            <div class="features">
                <div class="feature-card">
                    <h4>üß† Smart Parsing</h4>
                    <p>Understands natural language commands and extracts key information like quantities, items, and times.</p>
                </div>

                <div class="feature-card">
                    <h4>üéØ Action Execution</h4>
                    <p>Converts parsed commands into real actions like placing orders, navigating pages, and checking balances.</p>
                </div>

                <div class="feature-card">
                    <h4>üé§ Voice Integration</h4>
                    <p>Voice commands are automatically processed and executed, making hands-free operation possible.</p>
                </div>

                <div class="feature-card">
                    <h4>‚ö° Real-time Feedback</h4>
                    <p>Shows processing status and execution results with visual indicators and detailed responses.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Robot Button -->
    <button class="floating-robot" onclick="openRobotModal()">
        ü§ñ
    </button>

    <script>
        // Command parsing patterns (simplified version)
        const COMMAND_PATTERNS = [
            {
                pattern: /(?:order|buy|get|purchase)\s+(\d+)?\s*([^for\s]+(?:\s+[^for\s]+)*?)(?:\s+for\s+(.+))?/i,
                action: 'place_order',
                name: 'Order Items'
            },
            {
                pattern: /(?:open|go\s+to|navigate\s+to|show)\s+(gosellr|wallet|dashboard|franchise|services)/i,
                action: 'navigate',
                name: 'Navigation'
            },
            {
                pattern: /(?:check|show|get)\s+(?:my\s+)?(?:wallet\s+)?balance/i,
                action: 'check_balance',
                name: 'Check Balance'
            },
            {
                pattern: /(?:book|schedule|appointment)\s+([^for\s]+(?:\s+[^for\s]+)*?)(?:\s+for\s+(.+))?/i,
                action: 'book_service',
                name: 'Book Service'
            },
            {
                pattern: /(?:remind|set\s+reminder)\s+(?:me\s+)?(?:to\s+)?(.+?)(?:\s+(?:at|for)\s+(.+))?/i,
                action: 'set_reminder',
                name: 'Set Reminder'
            },
            {
                pattern: /(?:search|find|look\s+for)\s+(.+)/i,
                action: 'search',
                name: 'Search'
            },
            {
                pattern: /(?:help|what\s+can\s+you\s+do|how\s+can\s+you\s+help)/i,
                action: 'show_help',
                name: 'Help'
            }
        ];

        function parseCommand(input) {
            const normalizedInput = input.toLowerCase().trim();

            for (const pattern of COMMAND_PATTERNS) {
                const matches = normalizedInput.match(pattern.pattern);
                if (matches) {
                    return {
                        original: input,
                        action: pattern.action,
                        name: pattern.name,
                        matches: matches,
                        confidence: calculateConfidence(normalizedInput, pattern.pattern)
                    };
                }
            }

            return null;
        }

        function calculateConfidence(input, pattern) {
            const match = input.match(pattern);
            if (!match) return 0;

            let confidence = 0.7;
            if (match[0] === input) confidence += 0.2;
            if (match[0].length > input.length * 0.8) confidence += 0.1;

            return Math.min(confidence, 1.0);
        }

        async function executeCommand(parsedCommand) {
            const actions = {
                place_order: (params) => ({
                    success: true,
                    message: `‚úÖ Order placed for ${params.quantity || 1}x ${params.item}${params.deliveryTime ? ` for ${params.deliveryTime}` : ''}`,
                    orderId: `ORD-${Date.now()}`
                }),

                navigate: (params) => ({
                    success: true,
                    message: `üß≠ Navigating to ${params.page}`,
                    page: params.page
                }),

                check_balance: () => ({
                    success: true,
                    message: 'üí∞ Your wallet balance is 1,250 EHBGC',
                    balance: 1250
                }),

                book_service: (params) => ({
                    success: true,
                    message: `üîß Service booked: ${params.service}${params.time ? ` for ${params.time}` : ''}`,
                    bookingId: `BK-${Date.now()}`
                }),

                set_reminder: (params) => ({
                    success: true,
                    message: `‚è∞ Reminder set: ${params.task}${params.time ? ` for ${params.time}` : ''}`,
                    reminderId: `REM-${Date.now()}`
                }),

                search: (params) => ({
                    success: true,
                    message: `üîç Searching for: ${params.query}`,
                    results: []
                }),

                show_help: () => ({
                    success: true,
                    message: `I can help you with:
‚Ä¢ Order items: "Order 2 cold drinks"
‚Ä¢ Navigate: "Open GoSellr"
‚Ä¢ Check balance: "Show my wallet"
‚Ä¢ Book services: "Book AC repair"
‚Ä¢ Set reminders: "Remind me to order milk"
‚Ä¢ Search: "Find shoes"`,
                    help: true
                })
            };

            const handler = actions[parsedCommand.action];
            if (!handler) {
                return {
                    success: false,
                    message: `Sorry, I don't understand how to ${parsedCommand.action}`
                };
            }

            // Extract parameters based on action type
            let params = {};
            switch (parsedCommand.action) {
                case 'place_order':
                    params = {
                        quantity: parsedCommand.matches[1] ? parseInt(parsedCommand.matches[1]) : 1,
                        item: parsedCommand.matches[2]?.trim(),
                        deliveryTime: parsedCommand.matches[3]?.trim()
                    };
                    break;
                case 'navigate':
                    params = { page: parsedCommand.matches[1]?.toLowerCase() };
                    break;
                case 'book_service':
                    params = {
                        service: parsedCommand.matches[1]?.trim(),
                        time: parsedCommand.matches[2]?.trim()
                    };
                    break;
                case 'set_reminder':
                    params = {
                        task: parsedCommand.matches[1]?.trim(),
                        time: parsedCommand.matches[2]?.trim()
                    };
                    break;
                case 'search':
                    params = { query: parsedCommand.matches[1]?.trim() };
                    break;
            }

            return handler(params);
        }

        function addResult(message, type = 'success') {
            const resultsDiv = document.getElementById('results');
            const resultItem = document.createElement('div');
            resultItem.className = `result-item ${type}`;
            resultItem.innerHTML = `
                <strong>${type.toUpperCase()}:</strong> ${message}
                <br><small>${new Date().toLocaleTimeString()}</small>
            `;
            resultsDiv.appendChild(resultItem);
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }

        async function testCommand() {
            const input = document.getElementById('commandInput');
            const command = input.value.trim();

            if (!command) {
                addResult('Please enter a command to test', 'error');
                return;
            }

            addResult(`Processing: "${command}"`, 'processing');

            // Parse command
            const parsed = parseCommand(command);

            if (parsed) {
                addResult(`‚úÖ Parsed as: ${parsed.name} (confidence: ${Math.round(parsed.confidence * 100)}%)`, 'success');

                // Execute command
                const result = await executeCommand(parsed);
                addResult(result.message, result.success ? 'success' : 'error');
            } else {
                addResult(`‚ùå Could not parse: "${command}". Try a different command.`, 'error');
            }
        }

        function testExample(command) {
            document.getElementById('commandInput').value = command;
            testCommand();
        }

        function startVoiceInput() {
            if (!('webkitSpeechRecognition' in window)) {
                addResult('Voice recognition not supported in this browser', 'error');
                return;
            }

            const voiceBtn = document.getElementById('voiceBtn');
            voiceBtn.classList.add('listening');
            voiceBtn.textContent = 'üî¥ Listening...';

            const recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                document.getElementById('commandInput').value = transcript;
                voiceBtn.classList.remove('listening');
                voiceBtn.textContent = 'üé§ Voice';

                // Auto-test the command
                setTimeout(() => {
                    testCommand();
                }, 500);
            };

            recognition.onerror = function() {
                voiceBtn.classList.remove('listening');
                voiceBtn.textContent = 'üé§ Voice';
                addResult('Voice recognition error', 'error');
            };

            recognition.start();
        }

        function openRobotModal() {
            addResult('ü§ñ Robot modal would open here (Phase 1 feature)', 'success');
        }

        // Demo: Auto-add some example results
        setTimeout(() => {
            addResult('Ready to test commands! Try clicking on the example cards above.', 'success');
        }, 1000);
    </script>
</body>
</html>
